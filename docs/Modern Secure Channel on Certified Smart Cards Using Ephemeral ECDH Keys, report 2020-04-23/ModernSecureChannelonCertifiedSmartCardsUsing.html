<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=m0tazYRimFnV1hoGKbgtnw');ol.lst-kix_9t886upljyhb-1.start{counter-reset:lst-ctn-kix_9t886upljyhb-1 0}.lst-kix_3678zikeecgh-4>li:before{content:"+  "}.lst-kix_3678zikeecgh-5>li:before{content:"+  "}.lst-kix_3678zikeecgh-6>li:before{content:"+  "}.lst-kix_3678zikeecgh-7>li:before{content:"+  "}ul.lst-kix_3678zikeecgh-3{list-style-type:none}ul.lst-kix_3678zikeecgh-4{list-style-type:none}ul.lst-kix_3678zikeecgh-1{list-style-type:none}ul.lst-kix_3678zikeecgh-2{list-style-type:none}.lst-kix_3678zikeecgh-8>li:before{content:"+  "}ul.lst-kix_3678zikeecgh-0{list-style-type:none}ul.lst-kix_coyl374hnj21-3{list-style-type:none}ul.lst-kix_coyl374hnj21-4{list-style-type:none}ul.lst-kix_coyl374hnj21-5{list-style-type:none}ul.lst-kix_coyl374hnj21-6{list-style-type:none}ul.lst-kix_3678zikeecgh-7{list-style-type:none}ul.lst-kix_3678zikeecgh-8{list-style-type:none}ul.lst-kix_coyl374hnj21-0{list-style-type:none}ul.lst-kix_3678zikeecgh-5{list-style-type:none}ul.lst-kix_3678zikeecgh-6{list-style-type:none}ul.lst-kix_coyl374hnj21-2{list-style-type:none}ol.lst-kix_coyl374hnj21-1.start{counter-reset:lst-ctn-kix_coyl374hnj21-1 0}ul.lst-kix_coyl374hnj21-7{list-style-type:none}ul.lst-kix_coyl374hnj21-8{list-style-type:none}ul.lst-kix_9t886upljyhb-3{list-style-type:none}ul.lst-kix_9t886upljyhb-2{list-style-type:none}ul.lst-kix_9t886upljyhb-5{list-style-type:none}ul.lst-kix_9t886upljyhb-4{list-style-type:none}.lst-kix_9t886upljyhb-1>li{counter-increment:lst-ctn-kix_9t886upljyhb-1}ul.lst-kix_9t886upljyhb-7{list-style-type:none}ul.lst-kix_9t886upljyhb-6{list-style-type:none}ol.lst-kix_coyl374hnj21-1{list-style-type:none}ul.lst-kix_9t886upljyhb-8{list-style-type:none}.lst-kix_9t886upljyhb-1>li:before{content:"" counter(lst-ctn-kix_9t886upljyhb-1,decimal) ". "}.lst-kix_3678zikeecgh-3>li:before{content:"+  "}.lst-kix_9t886upljyhb-2>li:before{content:"\0025a0  "}.lst-kix_3678zikeecgh-2>li:before{content:"+  "}.lst-kix_9t886upljyhb-4>li:before{content:"\0025cb  "}.lst-kix_9t886upljyhb-3>li:before{content:"\0025cf  "}.lst-kix_3678zikeecgh-1>li:before{content:"+  "}.lst-kix_3678zikeecgh-0>li:before{content:"+  "}.lst-kix_y4dnm6p5imyc-6>li:before{content:"\0025cf  "}.lst-kix_y4dnm6p5imyc-7>li:before{content:"\0025cb  "}.lst-kix_9t886upljyhb-0>li:before{content:"\0025cf  "}.lst-kix_coyl374hnj21-0>li:before{content:"\0025cf  "}.lst-kix_y4dnm6p5imyc-8>li:before{content:"\0025a0  "}ul.lst-kix_y4dnm6p5imyc-3{list-style-type:none}ul.lst-kix_y4dnm6p5imyc-2{list-style-type:none}ul.lst-kix_y4dnm6p5imyc-1{list-style-type:none}.lst-kix_coyl374hnj21-1>li:before{content:"" counter(lst-ctn-kix_coyl374hnj21-1,decimal) ". "}.lst-kix_coyl374hnj21-3>li:before{content:"\0025cf  "}ul.lst-kix_y4dnm6p5imyc-0{list-style-type:none}.lst-kix_y4dnm6p5imyc-1>li:before{content:"\0025cb  "}.lst-kix_y4dnm6p5imyc-3>li:before{content:"\0025cf  "}ul.lst-kix_y4dnm6p5imyc-7{list-style-type:none}ul.lst-kix_y4dnm6p5imyc-6{list-style-type:none}ul.lst-kix_y4dnm6p5imyc-5{list-style-type:none}.lst-kix_coyl374hnj21-2>li:before{content:"\0025a0  "}.lst-kix_coyl374hnj21-6>li:before{content:"\0025cf  "}.lst-kix_y4dnm6p5imyc-2>li:before{content:"\0025a0  "}ul.lst-kix_y4dnm6p5imyc-4{list-style-type:none}.lst-kix_coyl374hnj21-5>li:before{content:"\0025a0  "}.lst-kix_y4dnm6p5imyc-5>li:before{content:"\0025a0  "}ul.lst-kix_y4dnm6p5imyc-8{list-style-type:none}.lst-kix_coyl374hnj21-4>li:before{content:"\0025cb  "}.lst-kix_y4dnm6p5imyc-4>li:before{content:"\0025cb  "}.lst-kix_9t886upljyhb-6>li:before{content:"\0025cf  "}.lst-kix_9t886upljyhb-5>li:before{content:"\0025a0  "}.lst-kix_coyl374hnj21-7>li:before{content:"\0025cb  "}.lst-kix_9t886upljyhb-8>li:before{content:"\0025a0  "}.lst-kix_9t886upljyhb-7>li:before{content:"\0025cb  "}.lst-kix_coyl374hnj21-8>li:before{content:"\0025a0  "}.lst-kix_y4dnm6p5imyc-0>li:before{content:"\0025cf  "}ul.lst-kix_4zgrt9c1ihoi-3{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-2{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-1{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-0{list-style-type:none}ul.lst-kix_9t886upljyhb-0{list-style-type:none}.lst-kix_4zgrt9c1ihoi-0>li:before{content:"\0025cf  "}.lst-kix_4zgrt9c1ihoi-3>li:before{content:"\0025cf  "}.lst-kix_4zgrt9c1ihoi-4>li:before{content:"\0025cb  "}.lst-kix_4zgrt9c1ihoi-6>li:before{content:"\0025cf  "}.lst-kix_4zgrt9c1ihoi-5>li:before{content:"\0025a0  "}ul.lst-kix_4zgrt9c1ihoi-7{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-6{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-5{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-4{list-style-type:none}ul.lst-kix_4zgrt9c1ihoi-8{list-style-type:none}.lst-kix_4zgrt9c1ihoi-2>li:before{content:"\0025a0  "}.lst-kix_4zgrt9c1ihoi-1>li:before{content:"\0025cb  "}ol.lst-kix_9t886upljyhb-1{list-style-type:none}.lst-kix_tauqwj9orb2v-8>li:before{content:"+  "}.lst-kix_tauqwj9orb2v-6>li:before{content:"+  "}.lst-kix_tauqwj9orb2v-7>li:before{content:"+  "}.lst-kix_tauqwj9orb2v-4>li:before{content:"+  "}.lst-kix_tauqwj9orb2v-5>li:before{content:"+  "}.lst-kix_coyl374hnj21-1>li{counter-increment:lst-ctn-kix_coyl374hnj21-1}.lst-kix_4zgrt9c1ihoi-8>li:before{content:"\0025a0  "}ul.lst-kix_tauqwj9orb2v-7{list-style-type:none}.lst-kix_tauqwj9orb2v-0>li:before{content:"+  "}.lst-kix_tauqwj9orb2v-2>li:before{content:"+  "}ul.lst-kix_tauqwj9orb2v-8{list-style-type:none}ul.lst-kix_tauqwj9orb2v-5{list-style-type:none}ul.lst-kix_tauqwj9orb2v-6{list-style-type:none}ul.lst-kix_tauqwj9orb2v-3{list-style-type:none}.lst-kix_4zgrt9c1ihoi-7>li:before{content:"\0025cb  "}.lst-kix_tauqwj9orb2v-3>li:before{content:"+  "}ul.lst-kix_tauqwj9orb2v-4{list-style-type:none}ul.lst-kix_tauqwj9orb2v-1{list-style-type:none}ul.lst-kix_tauqwj9orb2v-2{list-style-type:none}ul.lst-kix_tauqwj9orb2v-0{list-style-type:none}.lst-kix_tauqwj9orb2v-1>li:before{content:"+  "}ol{margin:0;padding:0}table td,table th{padding:0}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Courier New";font-style:normal}.c10{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}.c29{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c14{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}.c17{padding-top:10pt;padding-bottom:16pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c25{padding-top:10pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center;height:11pt}.c27{padding-top:10pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c9{padding-top:10pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c15{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c12{color:#000000;font-weight:400;text-decoration:none;font-size:10pt;font-family:"Courier New";font-style:normal}.c6{margin-left:28.3pt;padding-top:0pt;text-indent:-28.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c7{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:justify}.c21{color:#000000;text-decoration:none;font-size:18pt;font-style:normal}.c30{color:#000000;text-decoration:none;font-size:25pt;font-style:normal}.c8{color:#000000;text-decoration:none;font-size:11pt;font-style:normal}.c16{color:#000000;text-decoration:none;font-size:16pt;font-style:normal}.c18{color:#666666;text-decoration:none;font-size:15pt;font-style:normal}.c24{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c19{color:#000000;text-decoration:none;font-size:11pt}.c11{margin-left:72pt;padding-left:0pt}.c3{padding:0;margin:0}.c22{margin-left:144pt;padding-left:0pt}.c13{margin-left:36pt;padding-left:0pt}.c23{font-weight:400;font-family:"Courier New"}.c1{font-weight:400;font-family:"Cambria"}.c26{margin-left:108pt;padding-left:0pt}.c4{font-style:italic}.c28{height:11pt}.c20{margin-left:36pt}.c5{font-weight:700}.c2{vertical-align:baseline}.title{padding-top:0pt;color:#000000;font-size:25pt;padding-bottom:3pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:10pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:11pt;font-family:"Cambria"}p{margin:0;color:#000000;font-size:11pt;font-family:"Cambria"}h1{padding-top:20pt;color:#000000;font-size:18pt;padding-bottom:6pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Cambria";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:justify}</style></head><body class="c24"><div><p class="c9 c28"><span class="c8 c1 c2"></span></p></div><p class="c29 title" id="h.xq7cqesz7od"><span>Modern Secure Channel on Certified Smart Cards Using Ephemeral ECDH Keys</span></p><p class="c17 subtitle" id="h.p2v8dpwbvwqi"><span class="c18 c1 c2">Emerald Password Manager for Smart Cards</span></p><p class="c17 subtitle" id="h.t46jdmfrlaej"><span class="c1 c2 c18">Martin Vondracek, Elena Solodkova, Oldrich Tristan Florian</span></p><h1 class="c10" id="h.1p30l2ebzuih"><span>1.</span><span class="c21 c1 c2">&nbsp;Introduction</span></h1><p class="c9"><span class="c8 c1 c2">The project aims to create a JavaCard applet and a PC application for secure channel communication. The user is provided with a smart card (Java Card) with pre-personalized 4-digit PIN and a paper with this PIN printed. If the user wants to use the card, they have to put it into the reader and type in the PIN. </span></p><p class="c9"><span class="c8 c1 c2">Before any session, both card and a user (via implemented PC application) need to be mutually authenticated, and all subsequent data exchange between them needs to be protected by a secure channel. The PIN is never transmitted to the card or back. Therefore, they use it to establish an initial secret for the secure channel using a key exchange over an elliptic curve, which can then be used to derive session keys.</span></p><h1 class="c10" id="h.71tfmrpohat"><span>2. </span><span>Password-Authenticated Key Exchange by Juggling</span></h1><p class="c9"><span>Password-Authenticated Key Exchange (PAKE) is a technique to establish secure communication between two parties solely based on their shared password </span><span class="c2">[1, p. 2]</span><span>. We wanted to use the elliptic curve cryptography, because since it saves time, cost, and space, its usage for a smart card seems the most appropriate </span><span class="c2">[2, p. 12]</span><span>. One of the PAKE techniques that is designed to work with elliptic curves is Password-Authenticated Key Exchange by Juggling (J-PAKE) </span><span class="c2">[1, p. 2]</span><span>, which we decided to implement</span><span class="c8 c1 c2">.</span></p><p class="c9"><span>Generally, there are two variants of J-PAKE. The first is the two-round J-PAKE protocol, which is entirely symmetric </span><span class="c2">[1, p. 8]</span><span>. The second is a three-pass variant, in which the protocol is completed in three passes instead of two rounds without losing security </span><span class="c2">[1, p. 8]</span><span>. The three-pass variant is considered a more practical one </span><span class="c2">[1, p. 8]</span><span>, we have decided to use it.</span></p><p class="c9"><span class="c8 c1 c2">The three-pass J-PAKE over elliptic curve works as follows [1, p. 7&ndash;9]:</span></p><ul class="c3 lst-kix_coyl374hnj21-0 start"><li class="c7 c13"><span class="c8 c1 c2">Three passes</span></li></ul><ol class="c3 lst-kix_coyl374hnj21-1 start" start="1"><li class="c7 c11"><span class="c8 c1 c2">Alice &ndash;&gt; Bob</span></li></ol><ul class="c3 lst-kix_coyl374hnj21-2 start"><li class="c7 c26"><span class="c19 c1 c4 c2">G1 = G x [x1]</span></li></ul><ul class="c3 lst-kix_coyl374hnj21-3 start"><li class="c7 c22"><span class="c4">G</span><span class="c8 c1 c2">&nbsp;is a generator (a point on an elliptic curve)</span></li><li class="c7 c22"><span class="c4">G x [x1]</span><span>&nbsp;is a multiplication of a point </span><span class="c4">G</span><span>&nbsp;with a scalar </span><span class="c19 c1 c4 c2">x1</span></li></ul><ul class="c3 lst-kix_coyl374hnj21-2"><li class="c7 c26"><span class="c19 c1 c4 c2">G2 = G x [x2]</span></li><li class="c7 c26"><span>ZKPs for </span><span class="c4">x1</span><span>&nbsp;and </span><span class="c1 c4 c2 c19">x2</span></li></ul><ul class="c3 lst-kix_coyl374hnj21-3 start"><li class="c7 c22"><span class="c4">x1</span><span>&nbsp;and </span><span class="c4">x2</span><span>&nbsp;are private keys chosen randomly from </span><span class="c19 c1 c4 c2">[1, n &ndash; 1]</span></li></ul><ol class="c3 lst-kix_coyl374hnj21-1" start="2"><li class="c7 c11"><span class="c8 c1 c2">Bob &ndash;&gt; Alice</span></li></ol><ul class="c3 lst-kix_coyl374hnj21-2 start"><li class="c7 c26"><span class="c19 c1 c4 c2">G3 = G x [x3]</span></li><li class="c7 c26"><span class="c19 c1 c4 c2">G4 = G x [x4]</span></li><li class="c7 c26"><span class="c4">B = (G1 + G2 + G3) x [x4*s]</span></li><li class="c7 c26"><span>ZKPs for </span><span class="c4">x3</span><span>, </span><span class="c4">x4</span><span>, and </span><span class="c19 c1 c4 c2">x4*s</span></li></ul><ul class="c3 lst-kix_coyl374hnj21-3 start"><li class="c7 c22"><span class="c4">s</span><span class="c8 c1 c2">&nbsp;is a secret value derived from PIN shared between Alice and Bob</span></li></ul><ol class="c3 lst-kix_coyl374hnj21-1" start="3"><li class="c7 c11"><span class="c8 c1 c2">Alice &ndash;&gt; Bob</span></li></ol><ul class="c3 lst-kix_coyl374hnj21-2 start"><li class="c7 c26"><span class="c19 c1 c4 c2">A = (G1 + G3 + G4) x [x2 * s]</span></li><li class="c7 c26"><span>ZKP for</span><span class="c19 c1 c4 c2">&nbsp;x2*s</span></li></ul><ul class="c3 lst-kix_coyl374hnj21-0"><li class="c7 c13"><span class="c8 c1 c2">Session keys computation</span></li></ul><ol class="c3 lst-kix_coyl374hnj21-1 start" start="1"><li class="c7 c11"><span>Alice computes </span><span class="c19 c1 c4 c2">Ka = (B &ndash; (G4 x [x2 * s])) x [x2]</span></li><li class="c7 c11"><span>Bob computes </span><span class="c19 c1 c4 c2">Kb = (A &ndash; (G2 x [x4 * s])) x [x4]</span></li><li class="c7 c11"><span class="c4">Ka</span><span>&nbsp;equals to </span><span class="c4">Kb</span><span>, which equals to </span><span class="c4">G x [(x1 + x3) * (x2 * x4 * s)]</span><span class="c8 c1 c2">&nbsp;</span></li></ol><h1 class="c10" id="h.hrvtldf090p6"><span>3. </span><span>Schnorr Non-Interactive Zero-Knowledge Proof</span></h1><p class="c9"><span class="c1">S</span><span>chnorr zero-knowledge proof </span><span class="c1">allows one to prove the knowledge of a discrete logarithm without revealing its value </span><span class="c2">[3, p. 2]</span><span class="c1">. The Schnorr </span><span>zero-knowledge</span><span class="c1">&nbsp;proof can be implemented over a finite field or an elliptic curve </span><span class="c2">[3, p. 3]</span><span class="c1">, and since we are using </span><span>J-PAKE</span><span class="c1">&nbsp;over an elliptic curve, </span><span>w</span><span class="c1">e </span><span>have</span><span class="c1">&nbsp;decided for the latter</span><span>. Also, as to the interactions of the prover and the verifier, there are two variants of the Schnorr zero-knowledge proof. One is an interactive variant that requires the verifier to issue a challenge, while the other is a non-interactive variant that does not require any interaction with the verifier for getting the result </span><span class="c2">[3, pp. 7</span><span>&ndash;</span><span class="c2">8]</span><span>. We have used the second variant since it is also recommended in the J-PAKE RFC </span><span class="c2">[1, p. 5]</span><span>.</span></p><p class="c9"><span class="c1">The non-interactive </span><span>variant of the </span><span class="c1">protocol works in </span><span>the following</span><span class="c1">&nbsp;</span><span>steps</span><span class="c1">&nbsp;</span><span class="c2">[3, pp. 7</span><span>&ndash;</span><span class="c2">8]</span><span class="c8 c1 c2">:</span></p><ul class="c3 lst-kix_9t886upljyhb-0 start"><li class="c15 c13"><span class="c8 c1 c2">Alice (the prover)</span></li></ul><ol class="c3 lst-kix_9t886upljyhb-1 start" start="1"><li class="c15 c11"><span>Alice computes her public key </span><span class="c4">A = G x [a]</span></li></ol><ul class="c3 lst-kix_9t886upljyhb-2 start"><li class="c15 c26"><span class="c4">a</span><span>&nbsp;is the private key chosen randomly from</span><span class="c19 c1 c4 c2">&nbsp;[1, n &ndash; 1]</span></li></ul><ol class="c3 lst-kix_9t886upljyhb-1" start="2"><li class="c15 c11"><span class="c1">Alice chooses a number </span><span class="c1 c4">v </span><span>randomly </span><span class="c1">from [1, n &ndash; 1] and computes </span><span class="c1 c4">V = G x [v]</span><span class="c1">. </span></li><li class="c11 c15"><span>Alice issues the challenge by using a secure cryptographic hash function. The challenge </span><span class="c4">c</span><span>&nbsp;is defined as </span><span class="c4">c = H(G || V || A || UserID)</span><span class="c8 c1 c2">.</span></li></ol><ul class="c3 lst-kix_9t886upljyhb-2 start"><li class="c15 c26"><span class="c4">UserID</span><span class="c8 c1 c2">&nbsp;is a unique identifier for the prover</span></li><li class="c15 c26"><span class="c8 c1 c2">We have used ALG_SHA_512 as the hash function</span></li></ul><ol class="c3 lst-kix_9t886upljyhb-1" start="4"><li class="c15 c11"><span class="c1">Alice computes the resul</span><span>t </span><span class="c1 c4">r = v &ndash; </span><span class="c1">(</span><span class="c1 c4">a * c</span><span class="c1">)</span><span class="c1 c4">&nbsp;mod n</span></li></ol><ul class="c3 lst-kix_9t886upljyhb-2 start"><li class="c15 c26"><span class="c4">n</span><span>&nbsp;is the prime order of the generator</span></li></ul><ol class="c3 lst-kix_9t886upljyhb-1" start="5"><li class="c15 c11"><span>Alice sends the </span><span class="c4">A</span><span>,</span><span class="c4">&nbsp;V,</span><span>&nbsp;and </span><span class="c4">r</span><span class="c8 c1 c2">&nbsp;to Bob.</span></li></ol><ul class="c3 lst-kix_9t886upljyhb-0"><li class="c15 c13"><span class="c8 c1 c2">Bob (the verifier)</span></li></ul><ol class="c3 lst-kix_9t886upljyhb-1 start" start="1"><li class="c15 c11"><span>Bob checks, if A is a valid point on the curve</span></li><li class="c15 c11"><span class="c8 c1 c2">Bob checks, if A x [h] is not the point at infinity</span></li></ol><ul class="c3 lst-kix_9t886upljyhb-2 start"><li class="c15 c26"><span class="c4">h</span><span class="c8 c1 c2">&nbsp;is the cofactor of the generated subgroup</span></li></ul><ol class="c3 lst-kix_9t886upljyhb-1" start="3"><li class="c15 c11"><span>Bob checks, if V is equal to </span><span class="c4">G x [r] + A x [c]</span></li></ol><h1 class="c10" id="h.u72w9t21xrep"><span class="c21 c1 c2">4. Secure Channel Protocol Design</span></h1><p class="c27"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 481.19px; height: 627.17px;"><img alt="" src="images/image1.png" style="width: 482.17px; height: 627.17px; margin-left: -0.49px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c27"><span class="c4">Figure 1 &ndash; Secure Channel Protocol Design</span></p><p class="c9"><span>J-PAKE provides us </span><span class="c5">authenticity </span><span>and </span><span class="c5">key agreement</span><span>, while Schnorr Non-Interactive Zero-Knowledge Proof allows us authentication without revealing the shared secret. Together, they provide </span><span class="c5">protection against brute-force attacks</span><span>. Generally, a secure PAKE protocol should provide offline and online dictionary attack resistance, forward secrecy, and known-key security </span><span class="c2">[1, p. 11]</span><span>. J-PAKE satisfies all of these requirements </span><span class="c2">[1, p. 12]</span><span>. </span></p><p class="c9"><span class="c8 c1 c2">Once the session key is successfully derived as a result of J-PAKE, secure channel can be established. This channel uses following scheme, where || symbol denotes concatenation:</span></p><p class="c9 c20"><span class="c0">IV || HMAC || EK(hashchain || plaintext)</span></p><p class="c9"><span>For the symmetric encryption (</span><span class="c4">EK</span><span>), AES-CBC with 256-bit key and 128-bit block size with padding according to ISO 9797 method 2 </span><span class="c2">[4]</span><span>. AES-CBC encryption is used with Initialization Vectors (</span><span class="c4">IVs</span><span>) which are generated with </span><span class="c5">cryptographically secure random number generator</span><span>&nbsp;on card. </span><span>AES generally provides us </span><span class="c5">confidentiality</span><span>. </span><span class="c5">Integrity</span><span>&nbsp;of messages is achieved with HMAC based on SHA-256</span><span>&nbsp;</span><span class="c2">[5]</span><span>. This keyed-hash message authentication code ensures that value of HMAC was generated by a legitimate party with correct HMAC key. </span><span class="c5">Protection against replay attacks</span><span class="c8 c1 c2">&nbsp;is delivered by use of hash chains implemented with SHA-256.</span></p><p class="c9"><span>Initially</span><span>, we wanted to use AES-GCM, but it seems that jCardSim does not support it, although it claims support for Java Card Platform Classic Edition 3.0.5 </span><span class="c2">[6]</span><span class="c8 c1 c2">.</span></p><p class="c9"><span>As already mentioned, J-PAKE establishes shared session key (Ka = Kb). Our protocol then performs key derivation, implemented as &nbsp;SHA-256, in order to obtain </span><span class="c5">separate keys for encryption and HMAC</span><span>. </span><span>Also, since we generate new keys in each session, it guarantees us </span><span class="c5">forward secrecy</span><span class="c8 c1 c2">. Therefore, we consider this protocol safe to use for a secure channel.</span></p><h2 class="c14" id="h.nibhnwch9xdz"><span class="c16 c1 c2">4.1. Protocol Design at APDU Level</span></h2><p class="c9"><span>Implemented applet supports communication via APDUs and Extended Length APDUs. The applet supports </span><span class="c5">plaintext messages</span><span>, </span><span class="c5">key agreement messages</span><span>, and </span><span class="c5">messages protected by our secure channel</span><span class="c8 c1 c2">. These three categories are identified by their APDU class byte values. As key agreement protocol requires sending two messages from PC to card, they are identified by value of APDU instruction byte.</span></p><p class="c9"><span>All sensitive data exchanged between PC and card are protected by our secure channel. Furthermore, Messages of implemented </span><span class="c4">Emerald Password Manager for Smart Cards</span><span>&nbsp;are </span><span class="c5">protected including their metadata</span><span>. </span></p><h1 class="c10" id="h.chhy1zz4pzsw"><span class="c21 c1 c2">5. Implementation</span></h1><p class="c9"><span class="c8 c1 c2">Our project is divided into three modules written in Java language as follows:</span></p><ul class="c3 lst-kix_y4dnm6p5imyc-0 start"><li class="c9 c13"><span class="c23">applet</span><span>: &nbsp;Java Card applet managing communication over our secure channel and providing messages to Sub-Applet </span><span class="c4">Emerald Password Manager for Smart Cards</span><span>. The top-level applet serves as a secure layver for generic Sub-Applets.</span><span class="c0">&nbsp;</span></li><li class="c9 c13"><span class="c23">emApplication</span><span>: PC application for communication with </span><span class="c4">Emerald Password Manager for Smart Cards</span><span class="c8 c1 c2">&nbsp;on Java Card in smart card reader over our secure channel.</span></li><li class="c9 c13"><span class="c23">emCardTools</span><span>: Tools for communication with smart card reader used in by the PC application and during end-to-end testing of the applet. These tools are integrated from </span><span class="c2">[7]</span><span>&nbsp;which was published under MIT license.</span></li></ul><p class="c9"><span>We utilized Gradle system for build process, dependency management, testing, and also easy execution. Gradle configuration for Java Card project was based on </span><span class="c2">[7]</span><span>&nbsp;(published under MIT license)</span><span>, but was extended to better fit needs of our team. </span><span>We have also found a bug in the Gradle template and created a pull request to the upstream </span><span class="c2">[8]</span><span>. &nbsp;Also, we aimed at using </span><span>JCMathLib</span><span>&nbsp;for low-level EC operations </span><span class="c2">[9]</span><span>, but we have encountered a bug and its integration was not successful</span><span>.</span><span class="c8 c1 c2">&nbsp;This bugs will be reported to upstream.</span></p><p class="c9"><span>Development in our team was organized based on simplified </span><span class="c4">Git Flow </span><span class="c8 c1 c2">methodology. All code integrated to development (and later to master) branch had to go through pull requests with code review, code testing and Static Application Security Testing (SAST).</span></p><p class="c9"><span>Source code of all implemented modules is available on project&rsquo;s repository </span><span class="c2">[10]</span><span>.</span></p><h2 class="c14" id="h.x07do3z5fyld"><span class="c16 c1 c2">5.1. Secure Channel Protocol</span></h2><p class="c9"><span>J-PAKE functionality is implemented inside </span><span class="c23">jpake </span><span>package. &nbsp;Since an asymmetric version of the protocol was chosen, the functionality is divided between two classes </span><span class="c23">jpakeActiveActor </span><span>(initiates the handshake) and </span><span class="c23">jpakePassiveActor</span><span>&nbsp;(for the follower). Classes </span><span class="c23">jpakeActiveFirstPayload</span><span>, </span><span class="c23">jpakeActiveSecondPayload</span><span>, and </span><span class="c23">jpakePassivePayload </span><span>provide methods for constructing payloads sent by each side and supporting functionality like getters and serialization/deserialization methods. For elliptic curve we choose </span><span class="c5">Curve25519</span><span class="c8 c1 c2">.</span></p><p class="c9"><span>As for the Schnorr non-interactive zero-knowledge proof, the prover&rsquo;s part is done in the constructor of the </span><span class="c23">SchnorrZKP </span><span>class that has getters for </span><span class="c4">A</span><span>, </span><span class="c4">V</span><span>, and </span><span class="c4">r</span><span>. To allow the verifier to verify the result of the ZKP, he uses a static </span><span class="c23">ZKPUtil </span><span>class. This class has methods for the computations necessary to be done both by PC and card, and a verification method for the verifier.</span></p><h2 class="c14" id="h.81vhs1ny9hah"><span class="c16 c1 c2">5.2. Smart Card Applet</span></h2><p class="c9"><span>The top-level applet is implemented as an extension of standard Java Card applet class. During installation, it requires PIN as installation parameter. The applet stores important data in persistent memory and properly clears session data during </span><span class="c23">select </span><span>and </span><span class="c23">deselect </span><span class="c8 c1 c2">events. This applet also allows basic plaintext communication. Key agreement and secure channel management is delegated to our implemented Secure Channel Manager. Decrypted messages are forwarded to Sub-Applet and responses are encrypted and sent as APDUs to PC.</span></p><p class="c9"><span>In case of any violations of our secure channel, the applet signals security alert. After three security alerts, the applet blocks itself and permanently refuses any communication. This is a </span><span class="c5">protection against PIN brute-force attack</span><span class="c8 c1 c2">.</span></p><h2 class="c14" id="h.30q0j8bbcelj"><span class="c1 c2 c16">5.3. Password Manager Sub-Applet</span></h2><p class="c9"><span>In order to demonstrate feasibility of our secure channel, we have implemented </span><span class="c4">Emerald Password Manager for Smart Cards</span><span class="c8 c1 c2">. This applet is able to process messages similar to APDUs. We have designed following protocol:</span></p><p class="c9"><span class="c2 c12">MESSAGE_TYPE || PASSWORD_SLOT_ID || PASSWORD_LENGTH || PASSWORD_VALUE</span></p><p class="c9"><span class="c8 c1 c2">Where MESSAGE_TYPE is one of following:</span></p><ul class="c3 lst-kix_4zgrt9c1ihoi-0 start"><li class="c9 c13"><span class="c0">MESSAGE_SET_PASSWORD</span></li><li class="c9 c13"><span class="c0">MESSAGE_OK_SET</span></li><li class="c9 c13"><span class="c0">MESSAGE_GET_PASSWORD</span></li><li class="c9 c13"><span class="c0">MESSAGE_OK_GET</span></li></ul><p class="c9"><span>This applet allows a user to securely store passwords in persistent memory of Smart Card and later retrieve them.</span></p><h2 class="c14" id="h.8z84wq1u56b1"><span class="c16 c1 c2">5.4. Computer Application</span></h2><p class="c9"><span>The computer application offers a simple Command Line Interface (CLI) for access to the </span><span class="c4">Password Manager for Smart Cards</span><span>&nbsp;applet on smart card. It can also connect to smart card in simulator for demonstration purposes. The application asks user for PIN. PIN is used only for subsequent key agreement. When session key is successfully created, entered PIN is discarded. This offers protection </span><span class="c5">against memory dump attack</span><span>&nbsp;after the PIN is discarded.</span></p><h1 class="c10" id="h.fif6i6yt9a5n"><span class="c21 c1 c2">6. Testing</span></h1><p class="c9"><span>Our solution is tested with </span><span class="c5">unit tests</span><span>&nbsp;and </span><span class="c5">end-to-end tests</span><span>&nbsp;with APDUs. We have utilized Continuous Integration (</span><span class="c5">Continuous Testing</span><span>) via TravisCI. Code was also continuously checked with </span><span class="c5">SAST </span><span>tools from Code Climate. Final codebase has </span><span class="c5">92 % test coverage</span><span class="c8 c1 c2">.</span></p><h1 class="c10" id="h.5q3fy5qe3ydr"><span class="c21 c1 c2">7. Conclusion</span></h1><p class="c9"><span>We have created a Java Card applet and a PC application for secure channel communication based on a shared 4-digit PIN. Furthermore, we have created a password manager as the basic functionality of the card. For authenticity, protection against brute-force attacks, offline and online dictionary attack resistance, forward secrecy, known-key security, and authentication without revealing the shared secret, we used J-PAKE with Schnorr NIZKP over elliptic curves. Confidentiality is provided by AES-CBC with IVs generated with cryptographically secure random number generator, integrity of messages is achieved with HMAC based on SHA-256, and protection against replay attacks is delivered by use of hash chains implemented with SHA-256. Protocol performs a key derivation, implemented as SHA-256, to obtain separate keys for encryption and HMAC. Forward secrecy is guaranteed by generating new keys in each session.</span></p><h1 class="c10" id="h.2kfenwp6gr23"><span class="c21 c1 c2">8. Bibliography</span></h1><p class="c6"><span class="c2">[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F. Hao, &ldquo;J-PAKE: Password-Authenticated Key Exchange by Juggling,&rdquo; </span><span class="c4 c2">IETF Tools</span><span class="c2">, Sep. 2017. https://tools.ietf.org/html/rfc8236 (accessed Apr. 20, 2020).</span></p><p class="c6"><span class="c2">[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A. Kayali, &ldquo;Elliptic Curve Cryptography and Smart Cards,&rdquo; SANS Institute, Feb. 2004. Available</span><span>: h</span><span class="c2">ttps://www.sans.org/reading-room/whitepapers/vpns/elliptic-curve-cryptography-smart-cards-1378.</span></p><p class="c6"><span class="c2">[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F. Hao, &ldquo;Schnorr Non-interactive Zero-Knowledge Proof,&rdquo; </span><span class="c4 c2">IETF Tools</span><span class="c2">, Sep. 2017. https://tools.ietf.org/html/rfc8235 (accessed Apr. 20, 2020).</span></p><p class="c6"><span class="c2">[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&ldquo;Cipher (Java Card API, Classic Edition),&rdquo; </span><span class="c4 c2">Oracle Help Center</span><span class="c2">, 2015. https://docs.oracle.com/javacard/3.0.5/api/javacardx/crypto/Cipher.html#ALG_AES_CBC_ISO9797_M2 (accessed Apr. 23, 2020).</span></p><p class="c6"><span class="c2">[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H. Krawczyk, M. Bellare, and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; </span><span class="c4 c2">IETF Tools</span><span class="c2">, Feb. 1997. https://tools.ietf.org/html/rfc2104 (accessed Apr. 20, 2020).</span></p><p class="c6"><span class="c2">[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&ldquo;AES-GCM (ALG_AES_GCM) is not supported. &middot; Issue #153 &middot; licel/jcardsim,&rdquo; </span><span class="c4 c2">GitHub</span><span class="c2">. https://github.com/licel/jcardsim/issues/153 (accessed Apr. 23, 2020).</span></p><p class="c6"><span class="c2">[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRoCS, &ldquo;JavaCard Template project with Gradle,&rdquo; </span><span class="c4 c2">GitHub</span><span class="c2">, Apr. 19, 2020. https://github.com/crocs-muni/javacard-gradle-template-edu (accessed Apr. 23, 2020).</span></p><p class="c6"><span class="c2">[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&ldquo;fix: JUnit test annotations for running tests with current gradle configuration by mvondracek &middot; Pull Request #4 &middot; crocs-muni/javacard-gradle-template-edu,&rdquo; </span><span class="c4 c2">GitHub</span><span class="c2">. https://github.com/crocs-muni/javacard-gradle-template-edu/pull/4 (accessed Apr. 23, 2020).</span></p><p class="c6"><span class="c2">[9]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OpenCrypto Project, &ldquo;JCMathLib,&rdquo; </span><span class="c4 c2">GitHub</span><span class="c2">, Aug. 03, 2019. https://github.com/OpenCryptoProject/JCMathLib (accessed Apr. 23, 2020).</span></p><p class="c6"><span class="c2">[10]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Team Emerald, &ldquo;Modern Secure Channel on Certified Smartcards Using Ephemeral ECDH Keys,&rdquo; </span><span class="c4 c2">GitHub</span><span class="c2">, Apr. 23, 2020. https://github.com/mvondracek/PV204_smartcards_Emerald (accessed Apr. 23, 2020).</span></p><h1 class="c10" id="h.hn8ec6ooca0b"><span class="c1 c2 c21">Appendix A: Application Output with APDU Traces</span></h1><p class="c7"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">Emerald Password Manager for Smartcards</span></p><p class="c7"><span class="c0">&nbsp; __</span></p><p class="c7"><span class="c0">&nbsp;(`/\</span></p><p class="c7"><span class="c0">&nbsp;`=\/\ __...--~~~~~-._ &nbsp; _.-~~~~~--...__</span></p><p class="c7"><span class="c0">&nbsp; `=\/\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\ / &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\</span></p><p class="c7"><span class="c0">&nbsp; &nbsp;`=\/ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;V &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\</span></p><p class="c7"><span class="c0">&nbsp; &nbsp;//_\___--~~~~~~-._ &nbsp;| &nbsp;_.-~~~~~~--...__\\</span></p><p class="c7"><span class="c0">&nbsp; // &nbsp;) (..----~~~~._\ | /_.~~~~----.....__\\</span></p><p class="c7"><span class="c0">&nbsp;===( &nbsp; &nbsp; )==========\\|//====================</span></p><p class="c7"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\___/ &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`---`</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Selected communication with EmeraldApplet in a simulator.</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Simulated applet was installed with PIN `1 2 3 4`.</span></p><p class="c7"><span class="c0">PC ... SC: Established connection to smartcard.</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Enter 4 digit PIN.</span></p><p class="c7"><span class="c0">1234</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Using PIN `[1, 2, 3, 4]`</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">Begin: demo plaintext</span></p><p class="c7"><span class="c0">PC --&gt; SC: Sending example plaintext message to card.</span></p><p class="c7"><span class="c0">--&gt; 0100000000</span></p><p class="c7"><span class="c0">--&gt; [0100000000] 5</span></p><p class="c7"><span class="c0">&lt;-- 00010203040506070809 9000 (10)</span></p><p class="c7"><span class="c0">&lt;-- 00010203040506070809 9000 (10) [13 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Received response:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></p><p class="c7"><span class="c0">End: demo plaintext</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">PC &lt;-&gt; SC: Key agreement started.</span></p><p class="c7"><span class="c0">--&gt; AA0100000001D708434F4D505554455241040EC2251ECF0DE5AF74972D5F5C4C0A4DC547D1E679A15C71FFB90B4E1454EDE633CC39DBC2CB55BAD614E503AA125BB5E6AE993A5F5E5CFC7821C2B66F81EFA241047D5A804E1D1F555DA8FF4ED8C52DF948F397DA15A6B929AF0BBDC19B97DE7302208B21A4A0003D31C190CC6C52737406C5A99CE21B07BA40C67AF901EBCE26BC41040EC2251ECF0DE5AF74972D5F5C4C0A4DC547D1E679A15C71FFB90B4E1454EDE633CC39DBC2CB55BAD614E503AA125BB5E6AE993A5F5E5CFC7821C2B66F81EFA241045B6FC83ECC7F4D05ED23415FD66131BF176BDC4535B9E33D9729F20D7BCE22252B24CD053348CBD23E3E05ECCDC18657779DB553AB61A4EFD25B5528EC3AAB392000E32A7C4B25FC9D7D2AF263D044BCB85631C1F4DB6F8700FA80016AC1DE0C0341047D5A804E1D1F555DA8FF4ED8C52DF948F397DA15A6B929AF0BBDC19B97DE7302208B21A4A0003D31C190CC6C52737406C5A99CE21B07BA40C67AF901EBCE26BC41041CD05F0CC75961C5A4BF39A1ECA1E5836A4FEA1E485F04CAD9FE76027B734D947D4E376DA7B458E080BAABA0518D44E1A33D633A03B369C7DE73B3B88BA8213C20FEF1BEF71FD0189A08427177CA6935E2355E41EE8BC301E0C75368BDB798203E</span></p><p class="c7"><span class="c0">--&gt; [AA0100000001D708434F4D505554455241040EC2251ECF0DE5AF74972D5F5C4C0A4DC547D1E679A15C71FFB90B4E1454EDE633CC39DBC2CB55BAD614E503AA125BB5E6AE993A5F5E5CFC7821C2B66F81EFA241047D5A804E1D1F555DA8FF4ED8C52DF948F397DA15A6B929AF0BBDC19B97DE7302208B21A4A0003D31C190CC6C52737406C5A99CE21B07BA40C67AF901EBCE26BC41040EC2251ECF0DE5AF74972D5F5C4C0A4DC547D1E679A15C71FFB90B4E1454EDE633CC39DBC2CB55BAD614E503AA125BB5E6AE993A5F5E5CFC7821C2B66F81EFA241045B6FC83ECC7F4D05ED23415FD66131BF176BDC4535B9E33D9729F20D7BCE22252B24CD053348CBD23E3E05ECCDC18657779DB553AB61A4EFD25B5528EC3AAB392000E32A7C4B25FC9D7D2AF263D044BCB85631C1F4DB6F8700FA80016AC1DE0C0341047D5A804E1D1F555DA8FF4ED8C52DF948F397DA15A6B929AF0BBDC19B97DE7302208B21A4A0003D31C190CC6C52737406C5A99CE21B07BA40C67AF901EBCE26BC41041CD05F0CC75961C5A4BF39A1ECA1E5836A4FEA1E485F04CAD9FE76027B734D947D4E376DA7B458E080BAABA0518D44E1A33D633A03B369C7DE73B3B88BA8213C20FEF1BEF71FD0189A08427177CA6935E2355E41EE8BC301E0C75368BDB798203E] 478</span></p><p class="c7"><span class="c0">&lt;-- 0443415244410428D02BD086FBB7C4BCA64D5EF179CC5BC3716956B3B0673548B6080CB5779C5F210077A52DEC726876F3AD052A698A581802B8A1BD7C6183F6AD6952AF419DD041040E14EDFE34D75E7587AD35320074BF3C36B3183490F876194A30EFB5196AE7482F2402FEDDEC88EAD67B1D5338B056DA1E86FFED46E9FAF62C5FB1594200F1F0410477ACE17A362AA6256AA4E2A6FF97A7CAC67C7014A4371E3C30531864BC86DD9716D79380053E8D7FAD101AEA3DD202B76F89299BFDF6BB3BB8B3E1D090A63433410428D02BD086FBB7C4BCA64D5EF179CC5BC3716956B3B0673548B6080CB5779C5F210077A52DEC726876F3AD052A698A581802B8A1BD7C6183F6AD6952AF419DD041046E8EF19C89BB491D3681D28F754112A8259FDDD67C435C72E49A6B06AF231E5C01C79C403DCB9D8AC332B53552BA80920DBC2B2F2F1D2D09A0787D5FE9E0DB222001F9705AD86ADA084C573B7389FBEAEFE8BAA3F4057123088CCDC04503C98E7241040E14EDFE34D75E7587AD35320074BF3C36B3183490F876194A30EFB5196AE7482F2402FEDDEC88EAD67B1D5338B056DA1E86FFED46E9FAF62C5FB1594200F1F0410431DD7485937CB4078C834EB0E5A16DE55E7ACDD8A925538C50425B70A52EE356264AD7303F8C22D4EF4ADC770D3E1906A2312AC818E7DB5053732FBFC1C4A5B22001014454DCD672E0B329148EB8EB4A59660E78FFC5119483D03FE5063C1D6E2541041C3D47BD209B9CC1AAA4B3D49D0C766290751D5C06755407115E09BF75CDDAC561CE12F206711531D4B7C85DAE9D47430C635757321F2B74DC5A5BE406EDB8B641047706187EC68A2445592E0DAF73F4B26F973709715C2CAF11D1FD4380B19F4615156EC8AE05CF413E2813194314265DC271AF319D57672011BE06216063ACC35C2001AC93F627606A83823D61EC412204BAC19455E04133884A6324C99EBE9DF294 9000 (698)</span></p><p class="c7"><span class="c0">&lt;-- 0443415244410428D02BD086FBB7C4BCA64D5EF179CC5BC3716956B3B0673548B6080CB5779C5F210077A52DEC726876F3AD052A698A581802B8A1BD7C6183F6AD6952AF419DD041040E14EDFE34D75E7587AD35320074BF3C36B3183490F876194A30EFB5196AE7482F2402FEDDEC88EAD67B1D5338B056DA1E86FFED46E9FAF62C5FB1594200F1F0410477ACE17A362AA6256AA4E2A6FF97A7CAC67C7014A4371E3C30531864BC86DD9716D79380053E8D7FAD101AEA3DD202B76F89299BFDF6BB3BB8B3E1D090A63433410428D02BD086FBB7C4BCA64D5EF179CC5BC3716956B3B0673548B6080CB5779C5F210077A52DEC726876F3AD052A698A581802B8A1BD7C6183F6AD6952AF419DD041046E8EF19C89BB491D3681D28F754112A8259FDDD67C435C72E49A6B06AF231E5C01C79C403DCB9D8AC332B53552BA80920DBC2B2F2F1D2D09A0787D5FE9E0DB222001F9705AD86ADA084C573B7389FBEAEFE8BAA3F4057123088CCDC04503C98E7241040E14EDFE34D75E7587AD35320074BF3C36B3183490F876194A30EFB5196AE7482F2402FEDDEC88EAD67B1D5338B056DA1E86FFED46E9FAF62C5FB1594200F1F0410431DD7485937CB4078C834EB0E5A16DE55E7ACDD8A925538C50425B70A52EE356264AD7303F8C22D4EF4ADC770D3E1906A2312AC818E7DB5053732FBFC1C4A5B22001014454DCD672E0B329148EB8EB4A59660E78FFC5119483D03FE5063C1D6E2541041C3D47BD209B9CC1AAA4B3D49D0C766290751D5C06755407115E09BF75CDDAC561CE12F206711531D4B7C85DAE9D47430C635757321F2B74DC5A5BE406EDB8B641047706187EC68A2445592E0DAF73F4B26F973709715C2CAF11D1FD4380B19F4615156EC8AE05CF413E2813194314265DC271AF319D57672011BE06216063ACC35C2001AC93F627606A83823D61EC412204BAC19455E04133884A6324C99EBE9DF294 9000 (698) [156 ms]</span></p><p class="c7"><span class="c0">--&gt; AAEE0000F008434F4D5055544552410445FD031F7C00927439729B903BC697E04ECD33BF7D92EF6F5CCD63E681F5824F16E60889ABA1DD23B6E5AB861C03E7CD27EBFA2B28BA3EB4B631FE27C8FA30D241040FB3003EAD31FEC0948E18EEA46ABC5B7593BBC11F0CEFF210569B8E3845618E1207E186CBF81C22E8670ED0FDDAE5ACDF1B28242FE2FB259C02AA6286A74A2A410434CB36E30B96EE6AEFAFEA1F9ABAC03E5AE9087D68F824161FC809A29A2254D025457AF8966D20ADBCCB8441D167742FC4C32676795A0558FB3485CEE830CEED20F5B30B06174A3FF2990FDAD9083AF899AEB499E6212AB6ED62B074438D7DB6CA</span></p><p class="c7"><span class="c0">--&gt; [AAEE0000F008434F4D5055544552410445FD031F7C00927439729B903BC697E04ECD33BF7D92EF6F5CCD63E681F5824F16E60889ABA1DD23B6E5AB861C03E7CD27EBFA2B28BA3EB4B631FE27C8FA30D241040FB3003EAD31FEC0948E18EEA46ABC5B7593BBC11F0CEFF210569B8E3845618E1207E186CBF81C22E8670ED0FDDAE5ACDF1B28242FE2FB259C02AA6286A74A2A410434CB36E30B96EE6AEFAFEA1F9ABAC03E5AE9087D68F824161FC809A29A2254D025457AF8966D20ADBCCB8441D167742FC4C32676795A0558FB3485CEE830CEED20F5B30B06174A3FF2990FDAD9083AF899AEB499E6212AB6ED62B074438D7DB6CA] 245</span></p><p class="c7"><span class="c0">&lt;-- 9000</span></p><p class="c7"><span class="c0">&lt;-- 9000 [58 ms]</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: New shared session key established.</span></p><p class="c7"><span class="c0">PC &lt;-&gt; SC: Key agreement finished successfully.</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">Begin: demo password storage</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Set password `All your` to slot 0.</span></p><p class="c7"><span class="c0">--&gt; EE000000806C5544797A91115DC3330EBD003851D2B5F4623E96E4D8374BE489F2BBE6D432CB9960A85C1860E9D73AA57C61FE1F5EFDDC82F16A10530663614CEA2E07E92CB84D240B2BE39175AA17A18771D4B925E6D6C86B6C9D329EA87A63DCAF13B8027D31192AB1913C501686EE477CB8718CA355FAE2CC70625EFAB2637F4C632A85</span></p><p class="c7"><span class="c0">--&gt; [EE000000806C5544797A91115DC3330EBD003851D2B5F4623E96E4D8374BE489F2BBE6D432CB9960A85C1860E9D73AA57C61FE1F5EFDDC82F16A10530663614CEA2E07E92CB84D240B2BE39175AA17A18771D4B925E6D6C86B6C9D329EA87A63DCAF13B8027D31192AB1913C501686EE477CB8718CA355FAE2CC70625EFAB2637F4C632A85] 133</span></p><p class="c7"><span class="c0">&lt;-- 6C5544797A91115DC3330EBD003851D277EC4E1E4984E6E48625A29F743D04AA7DAACEF16BC3FB49113C6EFBAF6F24E1FDDC82F16A10530663614CEA2E07E92CB84D240B2BE39175AA17A18771D4B9258F9E9F0700A00EFD8B2954D607FF67474D3B2F64B9DFE054798F20FDA09F79625A47EB3C3B73CACE279377B17AEAB147 9000 (128)</span></p><p class="c7"><span class="c0">&lt;-- 6C5544797A91115DC3330EBD003851D277EC4E1E4984E6E48625A29F743D04AA7DAACEF16BC3FB49113C6EFBAF6F24E1FDDC82F16A10530663614CEA2E07E92CB84D240B2BE39175AA17A18771D4B9258F9E9F0700A00EFD8B2954D607FF67474D3B2F64B9DFE054798F20FDA09F79625A47EB3C3B73CACE279377B17AEAB147 9000 (128) [9 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Password successfully set to slot 0.</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Set password `base are` to slot 1.</span></p><p class="c7"><span class="c0">--&gt; EE000000802AA2AB70039C5510DDF06420ECEB88922B52E5279A555F80CB88C49070560ADCFAE45A6F4BF00BB67CB1CAE5861E84DA8AB14DDA0173CB103AA8192ECE6BA16CE2D93F9B455C1C664BB14ED2E9A9B45A4090621A7A8FC2A5C04A328A27FECAC2F5E94BA70CB2866E2639E388E12A4B76609B08FF67A998C8F1B62F9E61A8BE7A</span></p><p class="c7"><span class="c0">--&gt; [EE000000802AA2AB70039C5510DDF06420ECEB88922B52E5279A555F80CB88C49070560ADCFAE45A6F4BF00BB67CB1CAE5861E84DA8AB14DDA0173CB103AA8192ECE6BA16CE2D93F9B455C1C664BB14ED2E9A9B45A4090621A7A8FC2A5C04A328A27FECAC2F5E94BA70CB2866E2639E388E12A4B76609B08FF67A998C8F1B62F9E61A8BE7A] 133</span></p><p class="c7"><span class="c0">&lt;-- 2AA2AB70039C5510DDF06420ECEB889288BF305A6D2258F98F00D6B3521BE9BE10F607E9242906C4252B3A9A48BE281A8AB14DDA0173CB103AA8192ECE6BA16CE2D93F9B455C1C664BB14ED2E9A9B45AFAE38E14A1D5714AD54E68F1DF27C095696754D5FCB1BFE52B2B03E352D3994F47FC75832CD85FDE3D473609A35189BA 9000 (128)</span></p><p class="c7"><span class="c0">&lt;-- 2AA2AB70039C5510DDF06420ECEB889288BF305A6D2258F98F00D6B3521BE9BE10F607E9242906C4252B3A9A48BE281A8AB14DDA0173CB103AA8192ECE6BA16CE2D93F9B455C1C664BB14ED2E9A9B45AFAE38E14A1D5714AD54E68F1DF27C095696754D5FCB1BFE52B2B03E352D3994F47FC75832CD85FDE3D473609A35189BA 9000 (128) [16 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Password successfully set to slot 1.</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Set password `belong to us` to slot 2.</span></p><p class="c7"><span class="c0">--&gt; EE0000008051373E8B6FDEC284DB569204CA13D2CADE730CAF8CDB8C74BDCCC7645A490C4064160499C9E582F7A731EC05993E43CEC58B75D5E0881EA907F5B0F300743647A7C670F9179CF458DE2CB868ED2F1E32C0CC4D053CD4EE826D294B190E2BB8D3E6AE868957CD5EE446557C28A4821590F4DDA1C1255A5E50813DB1EBDF65D093</span></p><p class="c7"><span class="c0">--&gt; [EE0000008051373E8B6FDEC284DB569204CA13D2CADE730CAF8CDB8C74BDCCC7645A490C4064160499C9E582F7A731EC05993E43CEC58B75D5E0881EA907F5B0F300743647A7C670F9179CF458DE2CB868ED2F1E32C0CC4D053CD4EE826D294B190E2BB8D3E6AE868957CD5EE446557C28A4821590F4DDA1C1255A5E50813DB1EBDF65D093] 133</span></p><p class="c7"><span class="c0">&lt;-- 51373E8B6FDEC284DB569204CA13D2CAD489256E41C77BA3A2B38AC15407406C4D4CAE18B5E550213F476E947ABC5A3BC58B75D5E0881EA907F5B0F300743647A7C670F9179CF458DE2CB868ED2F1E323B6D6A9958C6893FA9ACB99AA701A3A7DAB82881701228BD81646A0A8150EACD14D8BFDAC4090621E5AA769B159A6974 9000 (128)</span></p><p class="c7"><span class="c0">&lt;-- 51373E8B6FDEC284DB569204CA13D2CAD489256E41C77BA3A2B38AC15407406C4D4CAE18B5E550213F476E947ABC5A3BC58B75D5E0881EA907F5B0F300743647A7C670F9179CF458DE2CB868ED2F1E323B6D6A9958C6893FA9ACB99AA701A3A7DAB82881701228BD81646A0A8150EACD14D8BFDAC4090621E5AA769B159A6974 9000 (128) [32 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Password successfully set to slot 2.</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Get password from slot 2.</span></p><p class="c7"><span class="c0">--&gt; EE000000805DCAB02A0E3D50461E73F1BB7A9549A3499CA2A76951EB500F19537FFE8038DFAEDCC6D59390A5E4798FD34D56EACB38F08E733F9E2FF6B3516A8605F09D7188F4ADD16AC4E89F00A6B5DE6014757AA4000B9497503B3F80553E2C76F9FD8ECC06A078785318CBDE0A3656662171DB9E85E79565131E300B47CCCC674F773B63</span></p><p class="c7"><span class="c0">--&gt; [EE000000805DCAB02A0E3D50461E73F1BB7A9549A3499CA2A76951EB500F19537FFE8038DFAEDCC6D59390A5E4798FD34D56EACB38F08E733F9E2FF6B3516A8605F09D7188F4ADD16AC4E89F00A6B5DE6014757AA4000B9497503B3F80553E2C76F9FD8ECC06A078785318CBDE0A3656662171DB9E85E79565131E300B47CCCC674F773B63] 133</span></p><p class="c7"><span class="c0">&lt;-- 5DCAB02A0E3D50461E73F1BB7A9549A360B68484253509DD2331ECF30915D925A8BF106A4A7BACE834163F4A3BB0125AF08E733F9E2FF6B3516A8605F09D7188F4ADD16AC4E89F00A6B5DE6014757AA4419B93208E18598015C81823E6A7F137939B775475C1AFC6EAA68A686320321F1EA65DCE306A4EAB76E7C2D690FFABBD 9000 (128)</span></p><p class="c7"><span class="c0">&lt;-- 5DCAB02A0E3D50461E73F1BB7A9549A360B68484253509DD2331ECF30915D925A8BF106A4A7BACE834163F4A3BB0125AF08E733F9E2FF6B3516A8605F09D7188F4ADD16AC4E89F00A6B5DE6014757AA4419B93208E18598015C81823E6A7F137939B775475C1AFC6EAA68A686320321F1EA65DCE306A4EAB76E7C2D690FFABBD 9000 (128) [25 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Retrieved password `belong to us` from slot 2.</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Get password from slot 1.</span></p><p class="c7"><span class="c0">--&gt; EE00000080F9C06213585289654996F0C40467B9A6D7F54954EFD75ED4AC1E443A82253541460D0048FB1AC5FC5538A7C4E57EC1737B4917D289818FD9C5FD423D8A804D948037E034C671779CDED673BE311B632A04B2CD21E1E41C5AE6DE388E7CF1E2256EFFE7E477151716CBB8DFEBF79DDB1108BD87E47C34C2C150BF33CA138134A5</span></p><p class="c7"><span class="c0">--&gt; [EE00000080F9C06213585289654996F0C40467B9A6D7F54954EFD75ED4AC1E443A82253541460D0048FB1AC5FC5538A7C4E57EC1737B4917D289818FD9C5FD423D8A804D948037E034C671779CDED673BE311B632A04B2CD21E1E41C5AE6DE388E7CF1E2256EFFE7E477151716CBB8DFEBF79DDB1108BD87E47C34C2C150BF33CA138134A5] 133</span></p><p class="c7"><span class="c0">&lt;-- F9C06213585289654996F0C40467B9A65AE28846AE75892A269FCADC08A19DDA86238F00008E5E5396DD7BC446CCEA667B4917D289818FD9C5FD423D8A804D948037E034C671779CDED673BE311B632A930775DE0549B1FB99E6971DC8703313FC294F198B21613E5715CF03E1EA452E403469B8C881ED96FDCE47913BAD675A 9000 (128)</span></p><p class="c7"><span class="c0">&lt;-- F9C06213585289654996F0C40467B9A65AE28846AE75892A269FCADC08A19DDA86238F00008E5E5396DD7BC446CCEA667B4917D289818FD9C5FD423D8A804D948037E034C671779CDED673BE311B632A930775DE0549B1FB99E6971DC8703313FC294F198B21613E5715CF03E1EA452E403469B8C881ED96FDCE47913BAD675A 9000 (128) [35 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Retrieved password `base are` from slot 1.</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Get password from slot 0.</span></p><p class="c7"><span class="c0">--&gt; EE000000805B16A08C7A0C5F1570F966EF5FB5D40003AAF1A85495CA39009306859D882809FE4D26D6278C44215A0970F711F4937DC2F9466AEFE12B1AF0ED8ED51852210F8CA585C5E3DB7ABC42E240AF87B5DE6DE1EEA0F7896C1C14B750A694891FF1BAE861753672B15D514466F8E720D4B653FF4A237E164E6E8083438F387F83E722</span></p><p class="c7"><span class="c0">--&gt; [EE000000805B16A08C7A0C5F1570F966EF5FB5D40003AAF1A85495CA39009306859D882809FE4D26D6278C44215A0970F711F4937DC2F9466AEFE12B1AF0ED8ED51852210F8CA585C5E3DB7ABC42E240AF87B5DE6DE1EEA0F7896C1C14B750A694891FF1BAE861753672B15D514466F8E720D4B653FF4A237E164E6E8083438F387F83E722] 133</span></p><p class="c7"><span class="c0">&lt;-- 5B16A08C7A0C5F1570F966EF5FB5D400589EC4CBCA3CE72B83264DCA765397557B74D7FA600EC7904C814138EB658187C2F9466AEFE12B1AF0ED8ED51852210F8CA585C5E3DB7ABC42E240AF87B5DE6DF98B807B7B2238E4AE81607ED0F55F38C27F0F651C9C663D3CB0570542073FC80F351D5965D805E69D8306A50C620144 9000 (128)</span></p><p class="c7"><span class="c0">&lt;-- 5B16A08C7A0C5F1570F966EF5FB5D400589EC4CBCA3CE72B83264DCA765397557B74D7FA600EC7904C814138EB658187C2F9466AEFE12B1AF0ED8ED51852210F8CA585C5E3DB7ABC42E240AF87B5DE6DF98B807B7B2238E4AE81607ED0F55F38C27F0F651C9C663D3CB0570542073FC80F351D5965D805E69D8306A50C620144 9000 (128) [55 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Retrieved password `All your` from slot 0.</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">End: demo password storage</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">Done.</span></p><p class="c7"><span class="c0">exit</span></p><p class="c9 c28"><span class="c8 c1 c2"></span></p><h1 class="c10" id="h.meab996hzskj"><span class="c21 c1 c2">Appendix B: Application Output on Incorrect PIN</span></h1><p class="c9"><span class="c8 c1 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emerald Password Manager for Smartcards</span></p><p class="c7"><span class="c0">&nbsp; __</span></p><p class="c7"><span class="c0">&nbsp;(`/\</span></p><p class="c7"><span class="c0">&nbsp;`=\/\ __...--~~~~~-._ &nbsp; _.-~~~~~--...__</span></p><p class="c7"><span class="c0">&nbsp; `=\/\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\ / &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\</span></p><p class="c7"><span class="c0">&nbsp; &nbsp;`=\/ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;V &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\</span></p><p class="c7"><span class="c0">&nbsp; &nbsp;//_\___--~~~~~~-._ &nbsp;| &nbsp;_.-~~~~~~--...__\\</span></p><p class="c7"><span class="c0">&nbsp; // &nbsp;) (..----~~~~._\ | /_.~~~~----.....__\\</span></p><p class="c7"><span class="c0">&nbsp;===( &nbsp; &nbsp; )==========\\|//====================</span></p><p class="c7"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\___/ &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`---`</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Selected communication with EmeraldApplet in a simulator.</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Simulated applet was installed with PIN `1 2 3 4`.</span></p><p class="c7"><span class="c0">PC ... SC: Established connection to smartcard.</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Enter 4 digit PIN.</span></p><p class="c7"><span class="c0">9876</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Using PIN `[9, 8, 7, 6]`</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">Begin: demo plaintext</span></p><p class="c7"><span class="c0">PC --&gt; SC: Sending example plaintext message to card.</span></p><p class="c7"><span class="c0">--&gt; 0100000000</span></p><p class="c7"><span class="c0">--&gt; [0100000000] 5</span></p><p class="c7"><span class="c0">&lt;-- 00010203040506070809 9000 (10)</span></p><p class="c7"><span class="c0">&lt;-- 00010203040506070809 9000 (10) [1 ms]</span></p><p class="c7"><span class="c0">PC &lt;== SC: Received response:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></p><p class="c7"><span class="c0">End: demo plaintext</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">PC &lt;-&gt; SC: Key agreement started.</span></p><p class="c7"><span class="c0">--&gt; AA0100000001D708434F4D505554455241046235F24389C2A9F852FC9836F6ECC29BECB107B6EB5CEAB3E898E512C38B7C5E6823E61F7E77B344D2F0677C5A7ADAB3963661C749F566175A69C527E6077DF841040B0BA6617BACA9E89708336F0A44E8D7DD99FE4B998C443D1D8D493F5175AAE30AA1D0809E34B9E275B33C229DCE015E6C53E0B075020E5C0C03CD105B988CF441046235F24389C2A9F852FC9836F6ECC29BECB107B6EB5CEAB3E898E512C38B7C5E6823E61F7E77B344D2F0677C5A7ADAB3963661C749F566175A69C527E6077DF841040F15AC9506595C466B47C4796438977C42C6A8663FC01572E72063E04BA592FB23EDEFB47101312A5BA2031F70D4FDFA6C4E02074E370E930D95825F10238DB720F8D57A7421FE95BC354CDE4FA2E6B7B314EDEBFCDF312ACFE4E1D4A4D815638D41040B0BA6617BACA9E89708336F0A44E8D7DD99FE4B998C443D1D8D493F5175AAE30AA1D0809E34B9E275B33C229DCE015E6C53E0B075020E5C0C03CD105B988CF441046E86DDC60F1C65BC789C93A519EE5BC541C1F29DA1E24DB88BBFBCB466DC3836082251688BD02906FDBD4285245D487D00924E914858F2A401DE66218DBC144D20043C07E90A2A628B7CE2C2A7ED561EFDFD7A2E0A70D247DBB3D0FA685D10F050</span></p><p class="c7"><span class="c0">--&gt; [AA0100000001D708434F4D505554455241046235F24389C2A9F852FC9836F6ECC29BECB107B6EB5CEAB3E898E512C38B7C5E6823E61F7E77B344D2F0677C5A7ADAB3963661C749F566175A69C527E6077DF841040B0BA6617BACA9E89708336F0A44E8D7DD99FE4B998C443D1D8D493F5175AAE30AA1D0809E34B9E275B33C229DCE015E6C53E0B075020E5C0C03CD105B988CF441046235F24389C2A9F852FC9836F6ECC29BECB107B6EB5CEAB3E898E512C38B7C5E6823E61F7E77B344D2F0677C5A7ADAB3963661C749F566175A69C527E6077DF841040F15AC9506595C466B47C4796438977C42C6A8663FC01572E72063E04BA592FB23EDEFB47101312A5BA2031F70D4FDFA6C4E02074E370E930D95825F10238DB720F8D57A7421FE95BC354CDE4FA2E6B7B314EDEBFCDF312ACFE4E1D4A4D815638D41040B0BA6617BACA9E89708336F0A44E8D7DD99FE4B998C443D1D8D493F5175AAE30AA1D0809E34B9E275B33C229DCE015E6C53E0B075020E5C0C03CD105B988CF441046E86DDC60F1C65BC789C93A519EE5BC541C1F29DA1E24DB88BBFBCB466DC3836082251688BD02906FDBD4285245D487D00924E914858F2A401DE66218DBC144D20043C07E90A2A628B7CE2C2A7ED561EFDFD7A2E0A70D247DBB3D0FA685D10F050] 478</span></p><p class="c7"><span class="c0">&lt;-- 04434152444104120FD2D28BDB700F6A05492F1D68C2DE05AAC601A30FE6255F27F7FD132D0DA24E537D75DA25CE1D9E041B3AB190D191011F1BA933B43AC8468615A534D871C741040F632A00F9E4953CAA01957EF33828670F6AEC23A99629254B977AB2C10499557EA1480724340525C46E1BC808686DD541B4533A17DE6EC485ED17CFF38BC08F41045647C54A98F24428AAE92DF267887E3F68E332F4719F07CA95B56751B4A5891513DF32C2E37AEABDB6A471B4F4862F6F03340C3E9073D5B3FB68239D543767774104120FD2D28BDB700F6A05492F1D68C2DE05AAC601A30FE6255F27F7FD132D0DA24E537D75DA25CE1D9E041B3AB190D191011F1BA933B43AC8468615A534D871C7410432B9184B3A2231ED4B33B26721DA6A3E6CB3B9616853019273EE71E46525684408436F1108BF69269543B1D90B6EB415C5F1A5A89E92F512D0A862D164F815D020064AEF20845F88DCF30F5B76C4379EB11F50133602EE10FD0AD4CDAC816E2CC441040F632A00F9E4953CAA01957EF33828670F6AEC23A99629254B977AB2C10499557EA1480724340525C46E1BC808686DD541B4533A17DE6EC485ED17CFF38BC08F41040326C3CA03D58EB9B05ED5452E2EFD34F4A121BF57BA42A96840F12A9CDE7A8B3BD0992B153E1CDCFF61AB94F73588D5CF056C83FF93CF3EE52CA6AA15BFBC9B200167A0A02AF739D5E803BE8F11B4DC0442BC949ACD0EE27E604FCDC8A59D5DFA41043149E778491245D26E933242F1CF8E3D566A2D8AEB522B2902D19EDD33DD51213EF04615C462E31BD89DE628A266388169CF86358C4BB9A3579C282A413416B64104256BF7368F63DFC182CED8C7249B84CF3A93233CDA2D9395DB8AEE6C1C2D42DB3F6800354A39CADF252ED18913E177C59A880BA757C594A429171419C66253E220F68BD04192E05BC9F2E73E207B40E68E9E7900206987D930840CBD44D9B7412E 9000 (698)</span></p><p class="c7"><span class="c0">&lt;-- 04434152444104120FD2D28BDB700F6A05492F1D68C2DE05AAC601A30FE6255F27F7FD132D0DA24E537D75DA25CE1D9E041B3AB190D191011F1BA933B43AC8468615A534D871C741040F632A00F9E4953CAA01957EF33828670F6AEC23A99629254B977AB2C10499557EA1480724340525C46E1BC808686DD541B4533A17DE6EC485ED17CFF38BC08F41045647C54A98F24428AAE92DF267887E3F68E332F4719F07CA95B56751B4A5891513DF32C2E37AEABDB6A471B4F4862F6F03340C3E9073D5B3FB68239D543767774104120FD2D28BDB700F6A05492F1D68C2DE05AAC601A30FE6255F27F7FD132D0DA24E537D75DA25CE1D9E041B3AB190D191011F1BA933B43AC8468615A534D871C7410432B9184B3A2231ED4B33B26721DA6A3E6CB3B9616853019273EE71E46525684408436F1108BF69269543B1D90B6EB415C5F1A5A89E92F512D0A862D164F815D020064AEF20845F88DCF30F5B76C4379EB11F50133602EE10FD0AD4CDAC816E2CC441040F632A00F9E4953CAA01957EF33828670F6AEC23A99629254B977AB2C10499557EA1480724340525C46E1BC808686DD541B4533A17DE6EC485ED17CFF38BC08F41040326C3CA03D58EB9B05ED5452E2EFD34F4A121BF57BA42A96840F12A9CDE7A8B3BD0992B153E1CDCFF61AB94F73588D5CF056C83FF93CF3EE52CA6AA15BFBC9B200167A0A02AF739D5E803BE8F11B4DC0442BC949ACD0EE27E604FCDC8A59D5DFA41043149E778491245D26E933242F1CF8E3D566A2D8AEB522B2902D19EDD33DD51213EF04615C462E31BD89DE628A266388169CF86358C4BB9A3579C282A413416B64104256BF7368F63DFC182CED8C7249B84CF3A93233CDA2D9395DB8AEE6C1C2D42DB3F6800354A39CADF252ED18913E177C59A880BA757C594A429171419C66253E220F68BD04192E05BC9F2E73E207B40E68E9E7900206987D930840CBD44D9B7412E 9000 (698) [98 ms]</span></p><p class="c7"><span class="c0">--&gt; AAEE0000F008434F4D505554455241043C6C420B2BC5084DD2DA1649CAF6543AECF1233D7259775688A8F3B2F86822F67DF2D1D932F3F71E92F3150ED69E2DC45038CBE3528AADF46B82A14BFE3F6ADE41044E9A5621A0237E7141039BF5499C3A524F1E309352069137B7F052D24B46EB2955209F4707B36B4D845D086CFAA87FC336BC6A2AACB137694D38F36395C97DBC41043879C9CD3BE586E44F9BEE6404CCD86B07C6157A4620EEABCCF2CB5D8DC99FE2400788D3423271ECEDB441D88BFA8DFFA5F634DFF8E0AEBD494460B25FDD9532200AD8D772F956FE17FBA44FCEE42D672B79DC8898E89EAC2A6B6662511EB69C25</span></p><p class="c7"><span class="c0">--&gt; [AAEE0000F008434F4D505554455241043C6C420B2BC5084DD2DA1649CAF6543AECF1233D7259775688A8F3B2F86822F67DF2D1D932F3F71E92F3150ED69E2DC45038CBE3528AADF46B82A14BFE3F6ADE41044E9A5621A0237E7141039BF5499C3A524F1E309352069137B7F052D24B46EB2955209F4707B36B4D845D086CFAA87FC336BC6A2AACB137694D38F36395C97DBC41043879C9CD3BE586E44F9BEE6404CCD86B07C6157A4620EEABCCF2CB5D8DC99FE2400788D3423271ECEDB441D88BFA8DFFA5F634DFF8E0AEBD494460B25FDD9532200AD8D772F956FE17FBA44FCEE42D672B79DC8898E89EAC2A6B6662511EB69C25] 245</span></p><p class="c7"><span class="c0">&lt;-- 9000</span></p><p class="c7"><span class="c0">&lt;-- 9000 [36 ms]</span></p><p class="c7"><span class="c0">PC &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: New shared session key established.</span></p><p class="c7"><span class="c0">PC &lt;-&gt; SC: Key agreement finished successfully.</span></p><p class="c7"><span class="c0">##################################################</span></p><p class="c7"><span class="c0">Begin: demo password storage</span></p><p class="c7 c28"><span class="c0"></span></p><p class="c7"><span class="c0">PC --&gt; SC: Set password `All your` to slot 0.</span></p><p class="c7"><span class="c0">--&gt; EE000000806C5544797A91115DC3330EBD003851D207253D39C257A973E99ECF8FA9A7E49A4F421B560D00E07B4315C096CE2FC2DE0B27C0B900A7C7423D90C4564EC07C872C17D954DC3F6264EF09C2C9B025A7A2A3CC3B10A5133079C651D00A7ED6A081CCC579FA6105A87E01B75BD447621227F60FF1BEFB6E80015B0CCA7498D14ECF</span></p><p class="c7"><span class="c0">--&gt; [EE000000806C5544797A91115DC3330EBD003851D207253D39C257A973E99ECF8FA9A7E49A4F421B560D00E07B4315C096CE2FC2DE0B27C0B900A7C7423D90C4564EC07C872C17D954DC3F6264EF09C2C9B025A7A2A3CC3B10A5133079C651D00A7ED6A081CCC579FA6105A87E01B75BD447621227F60FF1BEFB6E80015B0CCA7498D14ECF] 133</span></p><p class="c7"><span class="c0">&lt;-- 9000</span></p><p class="c7"><span class="c0">&lt;-- 9000 [13 ms]</span></p><p class="c7"><span class="c0">Error: Error in communication with the card.</span></p><p class="c7"><span class="c0">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span></p><p class="c7"><span class="c0">@ &quot;IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!&quot; @</span></p><p class="c7"><span class="c0">@ &nbsp; &nbsp; PIN IS INCORRECT OR THIS SMARTCARD IS MALICIOUS &nbsp; &nbsp; @</span></p><p class="c7"><span class="c0">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span></p><p class="c7"><span class="c0">Detailed info about this error:</span></p><p class="c7"><span class="c0">applet.EmeraldProtocolException</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at applet.SecureChannelManagerBase.decrypt(SecureChannelManagerBase.java:172)</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at emapplication.EmeraldApplicationCli.setPassword(EmeraldApplicationCli.java:197)</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at emapplication.EmeraldApplicationCli.demoPasswordStorage(EmeraldApplicationCli.java:296)</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at emapplication.EmeraldApplicationCli.run(EmeraldApplicationCli.java:85)</span></p><p class="c7"><span class="c0">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at emapplication.EmeraldApplicationCli.main(EmeraldApplicationCli.java:52)</span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 69.04px; height: 52.86px;"><img alt="" src="images/image2.png" style="width: 69.04px; height: 52.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c0">exit</span></p><div><p class="c25"><span class="c8 c1 c2"></span></p></div></body></html>